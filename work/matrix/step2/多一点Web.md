1. 如何将一个 .png 图片文件的内容嵌入到网页中，并使用 img 标签显示该图片？（不考虑 mht）
   * `<img src="data: [mimetype] [; base64], <data>">`
2. 如何使用 HTTP 头来让浏览器“下载”一个文件，而非显示这个文件的内容？（之前我们已经知道，给 a 标签加入 download 属性可以做到这一点）
   * `Content-Disposition: attachment; filename="xxx"`
3. XSS 攻击和 CSRF 攻击是什么意思？借助现有 Matrix 系统上举一些你能想到的例子，并说明你能想到的防范方法。
   1. XSS
     * 跨站脚本攻击（Cross-site scripting，XSS）是一种安全漏洞，攻击者可以利用这种漏洞在网站上注入恶意的客户端代码。当被攻击者登陆网站时就会自动运行这些恶意代码，从而，攻击者可以突破网站的访问权限，冒充受害者。XSS 攻击中的恶意内容通常会将 cookies 或其他隐私信息发送给攻击者，将受害者重定向到由攻击者控制的网页，或是经由恶意网站在受害者的机器上进行其他恶意操作。
     1. 存储型 XSS
       * 注入型脚本永久存储在目标服务器上。当浏览器请求数据时，脚本从服务器上传回并执行。
       * 在 matrix 提交含有 `rm -rf` 的代码（不过不清楚是否会因为权限不够等原因而没有效果）
     2. 反射型 XSS
       * 当用户点击一个恶意链接，或者提交一个表单，或者进入一个恶意网站时，注入脚本进入被攻击者的网站。Web服务器将注入脚本，比如一个错误信息，搜索结果等 返回到用户的浏览器上。由于浏览器认为这个响应来自"可信任"的服务器，所以会执行这段脚本。
       * 在 matrix 的评测系统中注入返回“你A了”相关信息的脚本，导致使用者拿到错误的信息
     3. 基于 DOM 的 XSS
       * 通过修改原始的客户端代码，受害者浏览器的 DOM 环境改变，导致有效载荷的执行。也就是说，页面本身并没有变化，但由于DOM环境被恶意修改，有客户端代码被包含进了页面，并且意外执行。
       * 将使用者原本的代码移动到其他的 DOM 中，原来代码位置替换成攻击性脚本
     * 应对：
       * 不允许非同源网站/跨站/非信任域名下的直接访问，可以选择`重定向`到 vmatrix.org.cn 的首页
       * 在进行请求时，使用本地脚本对请求进行验证并加密，同时服务端也进行验证和解密操作，在拿到服务端的加密响应后，本地进行验证和解密，即 `CSP`
       * 服务端使用 docker 对内容进行验证，docker 的损坏似乎不会影响到本体（应该？）
       * 为避免跨域脚本 (XSS) 攻击，通过JavaScript的 Document.cookie API无法访问带有 `HttpOnly 标记`的Cookie，它们只应该发送给服务端。如果包含服务端 Session 信息的 Cookie 不想被客户端 JavaScript 脚本调用，那么就应该为其设置 HttpOnly 标记。
   2. CSRF
      * 跨站请求伪造（CSRF）是一种冒充受信任用户，向服务器发送非预期请求的攻击方式。例如，可以通过在跳转链接后的 URL 中加入`恶意参数`来完成非预期请求。实质上就是`欺骗用户的浏览器，让其以用户的名义运行操作`
      * 例子：通过添加恶意参数而使有TA/教师权限的账户实现题目/课程的删除（我在想屁吃
      * 应对
        * `STP (Synchronizer token pattern)`，使用客户端收到的来自服务端随机生成的 token 进行验证
        * 检查 http 头中用于`表明请求来源`的 Referer 字段，如果 Referer 字段来自于非预想中的网站，则能够识别出恶意访问，但是对于攻击使用者浏览器、篡改了 Referer 字段的情况莫得办法
        * `添加校验 token`，如果要求在访问敏感数据请求时，要求用户浏览器提供不保存在cookie中，并且攻击者无法伪造的数据作为校验，那么攻击者就无法再运行CSRF攻击。这种数据通常是窗体中的一个数据项。服务器将其生成并附加在窗体中，其内容是一个伪随机数。当客户端通过窗体提交请求时，这个伪随机数也一并提交上去以供校验。正常的访问时，客户端浏览器能够正确得到并传回这个伪随机数，而通过CSRF传来的欺骗性攻击中，攻击者无从事先得知这个伪随机数的值，服务端就会因为校验token的值为空或者错误，拒绝这个可疑请求。 -- wiki百科
4. 对于 Access-Control-Allow-Origin，如果我想同时允许来自 sysu.edu.cn 和 vmatrix.org.cn 两个网站的跨站请求，但又不想使用通配符 *，应该如何设置这个头？
   1. node.js 中，可以参考下列代码，对于多个域名，可以使用数组进行操作
``` javascript
app.all('*', function(req, res, next) { 
   if( req.headers.origin == 'https://www.sysu.edu.cn' || req.headers.origin == 'https://vmatrix.org.cn' ){ 
      res.header(“Access-Control-Allow-Origin”, req.headers.origin); 
      res.header(‘Access-Control-Allow-Methods’, ‘POST, GET’); 
      res.header(‘Access-Control-Allow-Headers’, ‘X-Requested-With’); 
      res.header(‘Access-Control-Allow-Headers’, ‘Content-Type’); 
   } 
   next(); 
}); 
```
   2. 使用 `CORS (Cross-Origin Resource Sharing)` 协议，参考 [这篇博客](https://www.fujieace.com/javascript/access-control-allow-origin-2.html)
     * 简单的COR请求，它可以直接向外域资源发起请求。它必须仅仅包含简单的方法和头
     * 如果COR包含复杂的方法和头，它需要发出预检验（Preflight）请求，它先向资源服务器发出一个OPTIONS方法、包含“Origin”头的请求。该回复可以控制COR请求的方法，HTTP头以及验证等信息。只有该请求获得允许以后，才会发起真实的外域请求。

5. 由于我们的服务器和客户端均在校园网内，所以相比公网上的设备，我们的安全风险“似乎”就没那么高了。那么，我们为什么还要使用 HTTPS 呢？说说你能想到的校内网络安全风险。
   * 校内有人想搞事，指看后台代码下饭（
6. HTTP 307 Internal Redirect 是干嘛用的？
   * Chrome、Firefox等浏览器里，当您尝试访问该域名下的内容时，会产生一个307 Internal Redirect（内部跳转），自动跳转到 `HTTPS 请求`。
   * 有利于保护隐私同时方便网址的输入（有些时候 http 和 https 分不清）
7. HSTS 头中有一个 preload 指令。虽然它不是标准的一部分，但是大部分浏览器都支持它，那么它到底解决了什么问题以至于被广泛支持？
   * 谷歌维护着一个 HSTS 预加载服务。按照如下指示成功提交你的域名后，浏览器将会永不使用非安全的方式连接到你的域名。虽然该服务是由谷歌提供的，但所有浏览器都有使用这份列表的意向（或者已经在用了）。
   * 能够使浏览器强制使用 https 进行连接，避免不小心使用了非安全方式连接导致了其他不可预知问题
8. 有没有什么办法通过 JavaScript 更新、删除一个 Cookie？以及能这么干的前提是 Cookie 没有设置 ______。
   * 更新
     * 通过直接对 document.cookie 进行赋值，这个字符串值是键值对格式，并且键与目标键一样
   * 删除
     * 通过更新对应的键中的过期时间为过去/保存时间为0来达成目标
   * httponly
9.  当你发布了一个新版本后，你发现用户仍然访问到了老版本，甚至出现了网页引用的资源 404 的情况。请问你需要从哪些方面去调查这个问题？或者说有没有什么具体的排查思路？
    1. 先查看访问日志，若请求没有问题，则排查服务端；若请求出现问题，则需要排查客户端
    2. 客户端的请求如果出现问题，需要考虑是否是浏览器缓存没有更新，尝试清除缓存后再次访问
    3. 如果访问是跳转访问，则需要考虑跳转链接是否没有更新或者参数出现错误
10.  使用浏览器开发者工具或其他工具研究 vmatrix.org.cn 当前的缓存策略，然后简要说明一下。
    * JS，CSS文件部分缓存到内存（memory），大量缓存到磁盘（disk）；缓存时间`max-age=315360000`，近乎永久；采用`etag`与`last-modified`分别进行校验
    * 图片文件使用`last-modified`进行验证，并且保持新鲜缓存度
    * html 文件没有设置缓存
11.  多线程下载工具是如何做到同时下载同一个文件的不同部分的？有何前提条件？
    * 服务端对文件进行分片（`前提`）
    * 客户端向服务端发送请求，拿到文件的相关信息
    * 通过这些相关信息，多线程下载工具创建多个线程，对不同的文件包进行下载
    * 当前线程的下载完成后，再次创建新的连接下载，直到整个文件下载结束

状态码
* `200` OK
* `403` 当（代理）服务器收到一个合法认证信息时，若该认证不能获取请求资源的权限，（代理）服务器会返回403响应状态，说明用户证书权限不够
* `401` 未认证
* `407` 未代理认证