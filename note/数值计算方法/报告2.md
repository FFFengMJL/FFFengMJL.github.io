# 报告2：1920.3和1945.81的外插值

米家龙 18342075

[TOC]

## 题目要求

对递增的2个数据`1920.0300`和`1945.8100`尝试用各种不同函数、公式或方法进行插值建模，进行外插值/外推计算，以求出该递增2数据的下一个数据（也即第3个数据）是多少

> 已知第3个数据理论上大于2019.7900

## 思路

1. 使用多种公式/方法进行插值建模（曲线拟合）
2. 通过建立的模型获得目标插值（第3个数据）
3. 进行数值对比

## 正式建模

### 1. $y = Ax + B$

#### 拉格朗日插值多项式

由于已知的只有两个数据，并且对于（线性）两点（并且`等步长`）的拉格朗日多项式，横坐标的取值并不会对插值造成影响，因此假设该两点为 $(0, 1920.3)$ 和 $(1, 1945.81)$，因此由拉格朗日插值多项式（线性）：
$$
P(x) = y_0 + (y_1 - y_0) \cdot \frac{x - x_0}{x_1 - x_0} \tag{1}
$$
可以得到结果为：
$$
\begin{aligned}
    P(x) & = 1920.03 + (1945.81 - 1920.03) \cdot \frac{x - 0}{1 - 0} \\
         & = 25.78 x + 1920.03
\end{aligned} 
\tag{2}
$$
* 假设第三个数据与前两个数据的`步长相同`，则对于下一个数据，即$x = 2$时，结果为$1971.6000$。
* 而对于步长不同的情况，如果要获得期望的结果，则需要 $x = \frac{2019.79 - 1920.03}{25.78} > 3.8696$。

#### 牛顿倍数差分多项式

已知对于两点，牛顿倍数差分多项式
$$
f(x) = b_0 + b_1 (x - x_0), \begin{cases}b_0 = y_0 \\ b_1 = \frac{y_1 - y_0}{x_1 - x_0} \end{cases} \tag{3}
$$
由于已知两点状况下的牛顿差分倍数多项式依然是线性的，经过变量替换后和拉格朗日插值多项式的结果等价，因此该方法的结论和拉格朗日一样，因此后面不再区分两种方法，只使用拉格朗日。

### 2. $y = \frac{A}{x} + B$

线性化后获得结果为
$$
Y = AX + B, \begin{cases} X = \frac 1 x \\ Y = y \end{cases} \tag{4}
$$

#### 假设两点都在y轴右边

由于该公式下 $x \not ={0}$ ，因此假设两点为$(1, 1920.03)$和$(2, 1945.81)$。

由拉格朗日多项式可以得到结果为
$$
\begin{aligned}
    P(X) & = 1920.03 + (1945.81 - 1920.03) \cdot \frac{X - 1}{\frac{1}{2} - 1} \\
         & = -51.56X + 1971.59 \\
         & = -\frac{51.56}{x} + 1971.59
\end{aligned}
\tag {5}
$$

* 对于等步长情况，下一个数据是$x = 3$时，得到结果为$y_2 \approx 1954.4033$。
* 对于非等步长的情况，如果想要结果满足预期，则需要$x = \frac{51.56}{1971.59 - 2019.79} < -1.0697$，这个结果不太符合预期。

#### 假设两点都在y轴左边

假设两点为$(-3, 1920.03)$和$(-2, 1945.81)$。

由拉格朗日公式可以得到结果为
$$
\begin{aligned}
    P(X) & = 1920.03 + (1945.81 - 1920.03) \cdot \frac{X - (-\frac{1}{3})}{(-\frac{1}{2}) - (-\frac{1}{3})} \\
         & = -154.68X + 1868.47 \\
         & = -\frac{154.68}{x} + 1868.47
\end{aligned}
\tag{6}
$$

* 对于等步长的情况，下一个数据是$x = -1$时，得到结果为$2023.1500$，符合预期。
* 对于非等步长的情况，若使得结果满足预期，则需要$0 > x = -\frac{154.68}{1868.47 - 2019.79} > -1.0222$。

### 3. $y = \frac{D}{x + C}$

线性化后得到
$$
Y = - \frac{1}{C} \cdot X + \frac{D}{C} , \begin{cases} X = x \cdot y \\ Y = y \end{cases} \tag{7}
$$

假设两点为$(1, 1920.03)$和$(2, 1945.81)$，在线性化后的公式中，两个点变为$(1920.03, 1920.03)$和$(3891.62, 1945.81)$。

由拉格朗日公式得到
$$
\begin{aligned}
    P(X) & = (1945.81 - 1920.03) \cdot \frac{X - 1920.03}{3891.62 - 1920.03} + 1920.03 \\
         & = 0.013075740899477X - 1894.924185200777
\end{aligned}
\tag{8}
$$

解方程可以得到
$$
y = \frac{-1.449190680488753 \times 10^5}{x - 76.477501939488064} \tag{9}
$$

* 等步长的情况下，即$x = 3$时，结果为$1972.291711389732$，不能够符合预期。
* 在非等步长的情况下，若能够取得预期的值，则需要$x = \frac{-1.449190680488753 \times 10^5}{2019.79} + 76.477501939488064 > 4.7279$。

### 4. $y = \frac{1}{Ax + B}$

线性化后得到
$$
Y = AX + B, \begin{cases} X = x \\ Y = \frac{1}{y} \end{cases}
\tag{10}
$$

假设两点为$(0, 1920.03)$和$(1, 1945.81)$，在线性化后的公式中，两个点变为$(0, \frac{1}{1920.03})$和$(1, \frac{1}{1945.81})$。

由拉格朗日多项式得到
$$
\begin{aligned}
    P(X) & = -6.900403193751828 \times 10^{-6}X + 5.208251954396546 \times 10^{-4} 
\end{aligned}
\tag{11}
$$

结果为

$$
y = \frac{1}{-6.900403193751828 \times 10^{-6}x + 5.208251954396546 \times 10^{-4}} \tag{12}
$$

* 等步长情况下，带入$x = 2$得到结果为$1972.291711389732$
* 非等步长的情况下，如果要满足期望，则需要$x \geq 3.727929930083506$

### 5. $y = \frac{x}{Ax + B}$

线性化后得到
$$
Y = BX + A, \begin{cases} X = \frac{1}{x} \\ Y = \frac{1}{y} \end{cases}
$$

假设两点为$(1, 1920.03)$和$(2, 1945.81)$，在线性化后的公式中，两个点变为$(1, \frac{1}{1920.03})$和$(\frac{1}{2}, \frac{1}{1945.81})$。

由拉格朗日多项式可以得到
$$
\begin{aligned}
    P(X) & = (\frac{1}{1945.81} - \frac{1}{1920.03}) \cdot \frac{X - 1}{\frac{1}{2} - 1} + \frac{1}{1920.03} \\
         & = 1.380080638750366 \times 10^{-5}X + 5.070243890521510 \times 10^{-4}
\end{aligned}
\tag{13}
$$

因此得到结果
$$
y = \frac{x}{5.070243890521510 \times 10^{-4}x + 1.380080638750366 \times 10^{-5}} \tag{14}
$$

* 对于等步长情况，$x = 3$时，结果为$1954.557867101709$。
* 对于非等步长情况，若能得到期望，则需要$x = -1.157454341857106$，说明该函数无法达到预期。

### 6. $y = A\ln x +B$

线性化得到
$$
Y = AX + B, \begin{cases} X = \ln x \\ Y = y \end{cases} \tag{15}
$$

假设两点为$(1, 1920.03)$和$(2, 1945.81)$，在线性化后的公式中，两个点变为$(0, 1920.03)$和$(\ln 2, 1945.81)$。

由拉格朗日多项式可以得到
$$
\begin{aligned}
    P(X) & = (1945.81 - 1920.03) \cdot \frac{X - 0}{\ln 2 - 0} + 1945.81 \\
         & = \frac{25.78}{\ln 2}X + 1945.81
\end{aligned}
\tag{16}
$$

结果为
$$
y = \frac{25.78}{\ln 2}\cdot \ln x + 1945.81 \tag{17}
$$

* 对于等步长情况，带入$x = 3$得到$y = \frac{25.78 \times \ln 3}{\ln 2} + 1945.81 = 1986.670333268591$，与预期有差距
* 对于非等步长的情况，如能够得到期望值，则需要$x = e^{\frac{(2019.79-1945.81)\times \ln 2}{25.78}} = 7.308961367665237$

### 7. $y = C \cdot x^A$

线性化得到
$$
Y = A \cdot X + B, \begin{cases} X = \ln x \\ Y = \ln y \\ B = \ln C \end{cases} \tag{18}
$$

假设两点为$(1, 1920.03)$和$(2, 1945.81)$，在线性化后的公式中，两个点变为$(0, \ln 1920.03)$和$(\ln 2, \ln 1945.81)$。

由拉格朗日多项式得
$$
\begin{aligned}
    P(X) & = \ln {\frac{1945.81}{1920.03}} \cdot \frac{X - 0}{\ln 2 - 0} + \ln 1920.03
\end{aligned}
\tag{19}
$$

结果为
$$
y = 1920.03 \cdot x^{\ln{\frac{1945.81}{1920.03}} \cdot \ln {\frac{1}{2}}} \tag{20}
$$

* 等步长情况，令$x = 3$，得$y = 1961.050499579706$。
* 非等步长情况下，若要符合预期，则需要$x = \sqrt[t]{\frac{2019.79}{1920.03}} = 13.907191669783790, t = \ln{\frac{1945.81}{1920.03}} \cdot \ln{\frac{1}{2}}$

### 8. $y = (Ax + B)^{-2}$

线性化后得到
$$
Y = A \cdot X + B, \begin{cases} X = x \\ Y = y^{-\frac{1}{2}} \end{cases} \tag{21}
$$

假设两点为$(0, 1920.03)$和$(1, 1945.81)$，在线性化后的公式中，两个点变为$(0, \frac{1}{\sqrt{1920.03}})$和$(1, \frac{1}{\sqrt{1945.81}})$。

代入拉格朗日多项式得
$$
\begin{aligned}
    P(X) & = (\frac{1}{\sqrt{1945.81}} - \frac{1}{\sqrt{1920.03}}) \cdot X + \frac{1}{\sqrt{1920.03}}
\end{aligned}
\tag{22}
$$

得到结果
$$
y = [(\frac{1}{\sqrt{1945.81}} - \frac{1}{\sqrt{1920.03}})x + \frac{1}{\sqrt{1920.03}}]^{-2} \tag{23}
$$

* 等步长情况下，代入$x = 2$得到$y = 1972.112724501197$
* 非等步长情况下，若要达到期望，则需要$x = 2.762589002118608$

### 9. $y = C \cdot x \cdot e^{-Dx}$

线性化得到
$$
Y = - DX + B, \begin{cases} X = x \\ Y = \ln{\frac{y}{x}} \\ B = \ln C \end{cases} \tag{24}
$$

假设两点为$(1, 1920.03)$和$(2, 1945.81)$，在线性化后的公式中，两个点变为$(1, \ln 1920.03)$和$(2, \ln \frac{1945.81}{2})$。

代入拉格朗日多项式得到
$$
\begin{aligned}
    P(X) & = \ln {\frac{1945.81}{2 \times 1920.03}} \cdot \frac{X - 1}{2 - 1} + \ln 1920.03 \\
         & = \ln {\frac{1945.81}{3840.06}} \cdot X + \ln 1920.03
\end{aligned}
\tag{25}
$$

结果为
$$
y = e^{[\ln {\frac{1945.81}{2 \times 1920.03}} \cdot x + \ln 1920.03 + \ln x]} = 1920.03 \cdot x \cdot e^{[\ln 1945.81 - \ln 3840.06]} \tag{26}
$$

* 等步长情况下，代入$x = 3$得到$y = 2918.7150$